<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocab Master - Duolingo Style</title>
    <style>
        :root {
            --duo-green: #58cc02;
            --duo-green-dark: #46a302;
            --duo-red: #ff4b4b;
            --duo-red-dark: #ea2b2b;
            --duo-blue: #1cb0f6;
            --duo-blue-dark: #1899d6;
            --duo-gray: #e5e5e5;
            --duo-text: #4b4b4b;
            --duo-text-light: #777;
            --bg-color: #ffffff;
        }

        * {
            box-sizing: border-box;
            font-family: 'Nunito', 'Segoe UI', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f7f7f7;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }

        /* Container for all screens */
        .screen-container {
            background-color: var(--bg-color);
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            height: 100vh;
            overflow: hidden;
        }

        /* --- SCREEN 1: WELCOME --- */
        #welcome-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
        }

        .mascot {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        .welcome-title {
            color: var(--duo-green);
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            color: var(--duo-text-light);
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        .input-group {
            width: 100%;
            margin-bottom: 20px;
        }

        .name-input {
            width: 100%;
            padding: 15px;
            font-size: 1.2rem;
            border: 2px solid var(--duo-gray);
            border-radius: 12px;
            text-align: center;
            outline: none;
            transition: border-color 0.3s;
            color: var(--duo-text);
        }

        .name-input:focus {
            border-color: var(--duo-blue);
        }

        /* --- SCREEN 2: QUIZ (Existing Styles) --- */
        #quiz-screen {
            display: none; /* Hidden by default */
            flex-direction: column;
            height: 100%;
        }

        header {
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .progress-container {
            flex-grow: 1;
            height: 16px;
            background-color: var(--duo-gray);
            border-radius: 8px;
            margin-right: 15px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--duo-green);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 8px;
        }

        .stats {
            color: var(--duo-green);
            font-weight: 800;
            font-size: 1.2rem;
        }

        main {
            flex: 1;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            overflow-y: auto;
        }

        h2 {
            color: var(--duo-text);
            font-size: 1.5rem;
            margin-bottom: 30px;
        }

        .definition-text {
            font-weight: 600;
            color: var(--duo-text);
            line-height: 1.5;
            font-size: 1.1rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }

        @media (min-width: 480px) {
            .options-grid { grid-template-columns: 1fr 1fr; }
        }

        .option-btn {
            background: #fff;
            border: 2px solid var(--duo-gray);
            border-bottom-width: 4px;
            border-radius: 12px;
            padding: 15px;
            font-size: 1.1rem;
            color: var(--duo-text);
            cursor: pointer;
            transition: all 0.1s;
            text-align: center;
        }

        .option-btn:active { transform: translateY(2px); border-bottom-width: 2px; }
        .option-btn.selected { background-color: #ddf4ff; border-color: var(--duo-blue); color: var(--duo-blue-dark); }
        .option-btn.correct { background-color: #d7ffb8; border-color: var(--duo-green); color: var(--duo-green-dark); }
        .option-btn.wrong { background-color: #ffdfe0; border-color: var(--duo-red); color: var(--duo-red-dark); }

        /* --- SCREEN 3: CONGRATULATIONS --- */
        #completion-screen {
            display: none;
            flex: 1;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            text-align: center;
            background-color: #d7ffb8; /* Light green bg */
        }
        
        .completion-icon {
            font-size: 6rem;
            margin-bottom: 20px;
        }

        .completion-title {
            color: var(--duo-green-dark);
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .completion-msg {
            color: var(--duo-text);
            font-size: 1.2rem;
            margin-bottom: 30px;
        }

        /* --- SHARED COMPONENTS --- */
        .bottom-sheet {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 600px;
            padding: 20px;
            border-top: 2px solid transparent;
            display: none;
            flex-direction: column;
            z-index: 100;
        }

        .bottom-sheet.correct { background-color: #d7ffb8; color: var(--duo-green-dark); display: flex; }
        .bottom-sheet.wrong { background-color: #ffdfe0; color: var(--duo-red-dark); display: flex; }

        .feedback-header { font-weight: 800; font-size: 1.5rem; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .feedback-text { font-size: 1rem; margin-bottom: 20px; color: var(--duo-text); }
        .example-sentence { font-style: italic; background: rgba(255,255,255,0.5); padding: 10px; border-radius: 8px; margin-bottom: 15px; }

        .action-btn {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            border: none;
            border-bottom: 4px solid;
            cursor: pointer;
            font-size: 1rem;
            transition: filter 0.2s;
        }

        .start-btn { background-color: var(--duo-blue); color: white; border-color: var(--duo-blue-dark); }
        .check-btn { background-color: var(--duo-green); color: white; border-color: var(--duo-green-dark); margin-top: auto; }
        .check-btn:disabled { background-color: var(--duo-gray); border-color: #bfbfbf; color: #afafaf; cursor: not-allowed; }
        .continue-btn { background-color: var(--duo-green); color: white; border-color: var(--duo-green-dark); }
        .bottom-sheet.wrong .continue-btn { background-color: var(--duo-red); border-color: var(--duo-red-dark); }

        .badge { font-size: 0.8rem; padding: 2px 8px; border-radius: 10px; margin-left: 5px; text-transform: uppercase; display: inline-block;}
        .badge-new { background: #eee; color: #777; }
        .badge-maintained { background: #ffbd00; color: #fff; }
        .badge-mastered { background: var(--duo-blue); color: #fff; }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        @media (max-height: 600px) {
            h2 { font-size: 1.2rem; margin-bottom: 15px; }
            .option-btn { padding: 10px; }
            .mascot { font-size: 3rem; }
        }
    </style>
</head>
<body>

<div class="screen-container">
    
    <div id="welcome-screen">
        <div class="mascot">ü¶â</div>
        <h1 class="welcome-title">Vocab Master</h1>
        <p class="welcome-subtitle">Memorize 50+ difficult words with spaced repetition.</p>
        
        <div class="input-group">
            <input type="text" id="username-input" class="name-input" placeholder="What is your name?" autocomplete="off">
        </div>
        
        <button id="start-btn" class="action-btn start-btn">Get Started</button>
    </div>

    <div id="quiz-screen">
        <header>
            <div class="progress-container">
                <div class="progress-bar" id="mastery-bar"></div>
            </div>
            <div class="stats">
                <span id="remaining-count">0</span> Left
            </div>
        </header>

        <main id="quiz-area">
            <h2>Select the correct word</h2>
            
            <div style="margin-bottom: 20px;">
                <p class="definition-text" id="question-text">...</p>
            </div>

            <div class="options-grid" id="options-container">
                </div>

            <div style="flex: 1"></div>
            <div style="padding: 20px; width: 100%;">
                <button id="check-btn" class="action-btn check-btn" disabled>Check</button>
            </div>
        </main>
    </div>

    <div id="completion-screen">
        <div class="completion-icon">üèÜ</div>
        <div class="completion-title">Congratulations <span id="final-user-name"></span>!</div>
        <p class="completion-msg">You have successfully mastered the entire vocabulary list.</p>
        <button onclick="location.reload()" class="action-btn continue-btn">Practice Again</button>
    </div>

    <div id="feedback-sheet" class="bottom-sheet">
        <div class="feedback-header" id="feedback-title"></div>
        <div class="feedback-text" id="feedback-detail"></div>
        <div class="example-sentence" id="feedback-example"></div>
        <button id="continue-btn" class="action-btn continue-btn">Continue</button>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

<script>
    // --- 1. Data Initialization ---
    const rawData = [
        {w:"foster", p:"v.", d:"to stimulate, promote, encourage", s:"To foster good health in the city, the mayor started a ‚ÄúGet out and exercise!‚Äù campaign."},
        {w:"fractious", p:"adj.", d:"troublesome or irritable", s:"Although the child insisted he wasn‚Äôt tired, his fractious behavior‚Äîespecially his decision to crush his cheese and crackers all over the Ô¨Çoor‚Äîconvinced everyone present that it was time to put him to bed."},
        {w:"fraught", p:"adj.", d:"Ô¨Ålled or accompanied with (usually used with ‚Äúwith‚Äù)", s:"Her glances in his direction were fraught with meaning, though precisely what meaning remained unclear."},
        {w:"frenetic", p:"adj.", d:"frenzied, hectic, frantic", s:"In the hours between night and morning, the frenetic pace of city life slows to a lull."},
        {w:"frivolous", p:"adj.", d:"of little importance, triÔ¨Çing", s:"Someday, all that anxiety about whether your zit will disappear before the prom will seem totally frivolous."},
        {w:"frugal", p:"adj.", d:"thrifty, economical", s:"Richard is so frugal that his diet consists almost exclusively of catÔ¨Åsh and chicken liver‚Äîthe two most inexpensive foods in the store."},
        {w:"furtive", p:"adj.", d:"secretive, sly", s:"Jane‚Äôs placement of her drugs in her sock drawer was not as furtive as she thought, as the sock drawer is the Ô¨Årst place most parents look."},
        {w:"garish", p:"adj.", d:"gaudy, in bad taste", s:"Mrs. Watson has poor taste and covers every object in her house with a garish gold lam√©."},
        {w:"garrulous", p:"adj.", d:"talkative, wordy", s:"Some talk show hosts are so garrulous that their guests can‚Äôt get a word in edgewise."},
        {w:"genial", p:"adj.", d:"friendly, affable", s:"Although he‚Äôs been known to behave like a real jerk, I would say that my brother is an overall genial guy."},
        {w:"gluttony", p:"n.", d:"overindulgence in food or drink", s:"Ada‚Äôs fried chicken tastes so divine, I don‚Äôt know how anyone can call gluttony a sin."},
        {w:"goad", p:"v.", d:"to urge, spur, incite to action", s:"Jim may think he‚Äôs not going to Ô¨Åght Billy, but Billy will goad Jim on with insults until he throws a punch."},
        {w:"gourmand", p:"n.", d:"someone fond of eating and drinking", s:"My parents, who used to eat little more than crackers and salad, have become real gourmands in their old age."},
        {w:"grandiloquence", p:"n.", d:"lofty, pompous language", s:"The student thought her grandiloquence would make her sound smart, but neither the class nor the teacher bought it."},
        {w:"grandiose", p:"adj.", d:"on a magniÔ¨Åcent or exaggerated scale", s:"Margaret planned a grandiose party, replete with elephants, trapeze artists, and clowns."},
        {w:"gratuitous", p:"adj.", d:"uncalled for, unwarranted", s:"Every morning the guy at the donut shop gives me a gratuitous helping of ketchup packets."},
        {w:"gregarious", p:"adj.", d:"drawn to the company of others, sociable", s:"Well, if you‚Äôre not gregarious, I don‚Äôt know why you would want to go to a singles party!"},
        {w:"grievous", p:"adj.", d:"injurious, hurtful; serious or grave in nature", s:"Electrocuting the inmate without being sure of his guilt would be a truly grievous mistake."},
        {w:"guile", p:"n.", d:"deceitful, cunning, sly behavior", s:"Because of his great guile, the politician was able to survive scandal after scandal."},
        {w:"hackneyed", p:"adj.", d:"unoriginal, trite", s:"A girl can only hear ‚ÄúI love you‚Äù so many times before it begins to sound hackneyed and meaningless."},
        {w:"hallowed", p:"adj.", d:"revered, consecrated", s:"In the hallowed corridors of the cathedral, the disturbed professor felt himself to be at peace."},
        {w:"hapless", p:"adj.", d:"unlucky", s:"My poor, hapless family never seems to pick a sunny week to go on vacation."},
        {w:"harangue", p:"n.", d:"a ranting speech", s:"Everyone had heard the teacher‚Äôs harangue about gum chewing in class before."},
        {w:"hardy", p:"adj.", d:"robust, capable of surviving through adverse conditions", s:"I too would have expected the plants to be dead by mid-November, but apparently they‚Äôre very hardy."},
        {w:"harrowing", p:"adj.", d:"greatly distressing, vexing", s:"The car crash was a harrowing experience, but I have a feeling that the increase in my insurance premiums will be even more upsetting."},
        {w:"haughty", p:"adj.", d:"disdainfully proud", s:"The superstar‚Äôs haughty dismissal of her costars will backÔ¨Åre on her someday."},
        {w:"hedonist", p:"n.", d:"one who believes pleasure should be the primary pursuit of humans", s:"Because he‚Äôs such a hedonist, I knew Murray would appreciate the 11 cases of wine I bought him for his birthday."},
        {w:"hegemony", p:"n.", d:"domination over others", s:"Britain‚Äôs hegemony over its colonies was threatened once nationalist sentiment began to spread around the world."},
        {w:"heinous", p:"adj.", d:"shockingly wicked, repugnant", s:"The killings were made all the more heinous by the fact that the murderer Ô¨Årst tortured his victims for three days."},
        {w:"heterogeneous", p:"adj.", d:"varied, diverse in character", s:"I hate having only one Ô¨Çavor so I always buy the swirled, or should I say heterogeneous, type of ice cream."},
        {w:"blandish", p:"v.", d:"to coax by using Ô¨Çattery", s:"Rachel‚Äôs assistant tried to blandish her into accepting the deal."},
        {w:"blemish", p:"n.", d:"an imperfection, Ô¨Çaw", s:"The dealer agreed to lower the price because of the many blemishes on the surface of the wooden furniture."},
        {w:"blight", p:"n.", d:"a plague, disease", s:"The potato blight destroyed the harvest and bankrupted many families."},
        {w:"boisterous", p:"adj.", d:"loud and full of energy", s:"The candidate won the vote after giving several boisterous speeches on television."},
        {w:"bombastic", p:"adj.", d:"excessively conÔ¨Ådent, pompous", s:"The singer‚Äôs bombastic performance disgusted the crowd."},
        {w:"boon", p:"n.", d:"a gift or blessing", s:"The good weather has been a boon for many businesses located near the beach."},
        {w:"bourgeois", p:"n.", d:"a middle-class person, capitalist", s:"Many businessmen receive criticism for their bourgeois approach to life."},
        {w:"brazen", p:"adj.", d:"excessively bold, brash", s:"Critics condemned the novelist‚Äôs brazen attempt to plagiarize Hemingway‚Äôs story."},
        {w:"brusque", p:"adj.", d:"short, abrupt, dismissive", s:"The captain‚Äôs brusque manner offended the passengers."},
        {w:"buffet", p:"v.", d:"to strike with force", s:"The strong winds buffeted the ships, threatening to capsize them."},
        {w:"burnish", p:"v.", d:"to polish, shine", s:"His mother asked him to burnish the silverware before setting the table."},
        {w:"buttress", p:"v.", d:"to support, hold up", s:"The column buttresses the roof above the statue."},
        {w:"cacophony", p:"n.", d:"tremendous noise, disharmonious sound", s:"The elementary school orchestra created a cacophony at the recital."},
        {w:"cadence", p:"n.", d:"a rhythm, progression of sound", s:"The pianist used the foot pedal to emphasize the cadence of the sonata."},
        {w:"cajole", p:"v.", d:"to urge, coax", s:"Fred‚Äôs buddies cajoled him into attending the bachelor party."},
        {w:"calamity", p:"n.", d:"an event with disastrous consequences", s:"The earthquake in San Francisco was a calamity worse than any other natural disaster in history."},
        {w:"calibrate", p:"v.", d:"to set, standardize", s:"The mechanic calibrated the car‚Äôs transmission to make the motor run most efÔ¨Åciently."},
        {w:"callous", p:"adj.", d:"harsh, cold, unfeeling", s:"The murderer‚Äôs callous lack of remorse shocked the jury."},
        {w:"calumny", p:"n.", d:"an attempt to spoil someone else‚Äôs reputation by spreading lies", s:"The local ofÔ¨Åcial‚Äôs calumny ended up ruining his opponent‚Äôs prospect of winning the election."},
        {w:"camaraderie", p:"n.", d:"brotherhood, jovial unity", s:"Camaraderie among employees usually leads to success in business."},
        {w:"candor", p:"n.", d:"honesty, frankness", s:"We were surprised by the candor of the mayor‚Äôs speech because he is usually rather evasive."},
        {w:"canny", p:"adj.", d:"shrewd, careful", s:"The canny runner hung at the back of the pack through much of the race to watch the other runners, and then sprinted past them at the end."},
        {w:"canvas", p:"n.", d:"a piece of cloth on which an artist paints", s:"Picasso liked to work on canvas rather than on bare cement."}
    ];

    // --- 2. State & Audio ---
    let vocabList = rawData.map(item => ({...item, progress: 0}));
    let currentItem = null;
    let selectedOption = null;
    let isAnswered = false;
    let userName = "";

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        const now = audioCtx.currentTime;

        if (type === 'correct') {
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(600, now);
            oscillator.frequency.exponentialRampToValueAtTime(1200, now + 0.1);
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
            oscillator.start();
            oscillator.stop(now + 0.4);
        } else if (type === 'wrong') {
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(150, now);
            oscillator.frequency.exponentialRampToValueAtTime(80, now + 0.3);
            gainNode.gain.setValueAtTime(0.3, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
            oscillator.start();
            oscillator.stop(now + 0.3);
        } else if (type === 'click') {
            oscillator.type = 'triangle';
            oscillator.frequency.setValueAtTime(300, now);
            gainNode.gain.setValueAtTime(0.1, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            oscillator.start();
            oscillator.stop(now + 0.05);
        }
    }

    // --- 3. Screen Management ---
    
    function startApp() {
        const input = document.getElementById('username-input');
        userName = input.value.trim() || "Friend"; // Default if empty
        
        // Initialize Audio context on first user interaction
        if (audioCtx.state === 'suspended') audioCtx.resume();
        
        document.getElementById('welcome-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'flex';
        
        generateQuestion();
    }

    function showCompletion() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('completion-screen').style.display = 'flex';
        document.getElementById('final-user-name').innerText = userName;
        
        // Heavy celebration confetti
        const duration = 3000;
        const end = Date.now() + duration;

        (function frame() {
            confetti({
                particleCount: 5,
                angle: 60,
                spread: 55,
                origin: { x: 0 }
            });
            confetti({
                particleCount: 5,
                angle: 120,
                spread: 55,
                origin: { x: 1 }
            });

            if (Date.now() < end) {
                requestAnimationFrame(frame);
            }
        }());
        
        playSound('correct');
    }

    // --- 4. Game Logic ---

    function generateQuestion() {
        // Filter out completed words (Level 4)
        const activeWords = vocabList.filter(i => i.progress < 4);

        if (activeWords.length === 0) {
            showCompletion();
            return;
        }

        // Pick random word
        currentItem = activeWords[Math.floor(Math.random() * activeWords.length)];

        // Pick distractors
        const otherWords = rawData.filter(w => w.w !== currentItem.w);
        const distractors = [];
        while(distractors.length < 3) {
            const r = otherWords[Math.floor(Math.random() * otherWords.length)];
            if (!distractors.includes(r)) distractors.push(r);
        }

        // Shuffle options
        const options = [currentItem, ...distractors];
        for (let i = options.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [options[i], options[j]] = [options[j], options[i]];
        }

        renderUI(currentItem, options);
    }

    function renderUI(target, options) {
        // Stats
        const activeCount = vocabList.filter(i => i.progress < 4).length;
        document.getElementById('remaining-count').innerText = activeCount;
        
        const totalLevels = rawData.length * 4;
        const currentLevels = vocabList.reduce((acc, curr) => acc + curr.progress, 0);
        document.getElementById('mastery-bar').style.width = `${(currentLevels/totalLevels)*100}%`;

        // Question
        const badgeLabel = ["New", "Learning", "Maintained", "Mastered"][target.progress];
        const badgeClass = ["badge-new", "badge-new", "badge-maintained", "badge-mastered"][target.progress];
        
        document.getElementById('question-text').innerHTML = 
            `(${target.p}) ${target.d} <span class="badge ${badgeClass}">${badgeLabel}</span>`;

        // Options
        const container = document.getElementById('options-container');
        container.innerHTML = '';
        
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.w;
            btn.onclick = () => selectOption(btn, opt.w);
            container.appendChild(btn);
        });

        // Reset UI
        selectedOption = null;
        isAnswered = false;
        document.getElementById('check-btn').innerText = "CHECK";
        document.getElementById('check-btn').disabled = true;
        document.getElementById('check-btn').style.display = 'block';
        document.getElementById('feedback-sheet').style.display = 'none';
        document.getElementById('feedback-sheet').className = 'bottom-sheet';
    }

    function selectOption(btnElement, word) {
        if (isAnswered) return;
        playSound('click');
        
        document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        btnElement.classList.add('selected');
        selectedOption = word;
        document.getElementById('check-btn').disabled = false;
    }

    function checkAnswer() {
        if (!selectedOption || isAnswered) return;
        isAnswered = true;

        const isCorrect = selectedOption === currentItem.w;
        const buttons = document.querySelectorAll('.option-btn');
        const checkBtn = document.getElementById('check-btn');
        const feedbackSheet = document.getElementById('feedback-sheet');

        buttons.forEach(btn => {
            if (btn.innerText === currentItem.w) {
                btn.classList.add('correct');
            } else if (btn.innerText === selectedOption && !isCorrect) {
                btn.classList.add('wrong');
            }
        });

        if (isCorrect) {
            currentItem.progress++;
            playSound('correct');
            confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 }, colors: ['#58cc02', '#ffffff'] });
            feedbackSheet.classList.add('correct');
            document.getElementById('feedback-title').innerHTML = '<span style="font-size:1.5em">‚úì</span> Excellent!';
        } else {
            playSound('wrong');
            feedbackSheet.classList.add('wrong');
            document.getElementById('feedback-title').innerHTML = '<span style="font-size:1.5em">‚úñ</span> Correct: ' + currentItem.w;
        }

        document.getElementById('feedback-detail').innerText = currentItem.d;
        document.getElementById('feedback-example').innerHTML = `"${currentItem.s}"`;

        checkBtn.style.display = 'none';
        feedbackSheet.style.display = 'flex';
        document.getElementById('continue-btn').focus();
    }

    // --- 5. Event Listeners ---

    document.getElementById('start-btn').addEventListener('click', startApp);
    document.getElementById('check-btn').addEventListener('click', checkAnswer);
    document.getElementById('continue-btn').addEventListener('click', () => {
        playSound('click');
        generateQuestion();
    });

    // Enter Key Logic
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            const welcomeVisible = document.getElementById('welcome-screen').style.display !== 'none';
            const quizVisible = document.getElementById('quiz-screen').style.display === 'flex';
            
            if (welcomeVisible) {
                startApp();
            } else if (quizVisible) {
                if (!isAnswered && selectedOption) {
                    checkAnswer();
                } else if (isAnswered) {
                    playSound('click');
                    generateQuestion();
                }
            }
        }
    });

</script>
</body>
</html>
