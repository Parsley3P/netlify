<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocab Master: Nunito Edition</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --duo-green: #58cc02;
            --duo-green-shadow: #46a302;
            --duo-red: #ff4b4b;
            --duo-red-shadow: #d42c2c;
            --duo-blue: #1cb0f6;
            --duo-blue-shadow: #1899d6;
            --duo-gray: #e5e5e5;
            --duo-gray-text: #afafaf;
            --duo-dark: #4b4b4b;
            --bg-color: #fff;
            --font-main: 'Nunito', sans-serif;
        }

        * {
            box-sizing: border-box;
            touch-action: manipulation;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--duo-dark);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- Layout --- */
        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            position: relative;
        }

        /* --- Welcome Screen --- */
        #welcome-screen, #end-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            text-align: center;
        }

        h1 {
            font-weight: 800;
            color: var(--duo-green);
            margin-bottom: 1.5rem;
            font-size: 2.2rem;
            letter-spacing: -1px;
        }

        p {
            font-size: 1.1rem;
            line-height: 1.5;
            color: #777;
        }

        input[type="text"] {
            font-family: var(--font-main);
            padding: 15px;
            border: 2px solid var(--duo-gray);
            border-radius: 15px;
            font-size: 1.2rem;
            width: 80%;
            margin-bottom: 20px;
            text-align: center;
            outline: none;
            transition: border-color 0.2s;
            font-weight: 600;
        }

        input[type="text"]:focus {
            border-color: var(--duo-blue);
        }

        /* --- Quiz Screen --- */
        #quiz-screen {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .header-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 20px;
        }

        .progress-bar-bg {
            background-color: var(--duo-gray);
            height: 16px;
            border-radius: 8px;
            flex-grow: 1;
            margin-left: 15px;
            overflow: hidden;
        }

        .progress-bar-fill {
            background-color: var(--duo-green);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 8px;
        }

        .word-status {
            font-size: 0.9rem;
            color: var(--duo-blue);
            font-weight: 700;
            margin-bottom: 10px;
            min-height: 20px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .question-box {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 30px;
            font-weight: 600;
            color: #3c3c3c;
        }

        .blank {
            display: inline-block;
            border-bottom: 3px solid var(--duo-gray);
            width: 80px;
            text-align: center;
            color: transparent;
        }

        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: auto;
        }

        /* --- Buttons --- */
        .btn {
            font-family: var(--font-main);
            background-color: #fff;
            border: 2px solid var(--duo-gray);
            border-bottom: 4px solid var(--duo-gray);
            border-radius: 16px;
            padding: 15px 20px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.1s;
            text-align: left;
            color: var(--duo-dark);
            width: 100%;
            font-weight: 600;
        }

        .btn:active {
            transform: translateY(2px);
            border-bottom-width: 2px;
        }

        .btn.selected {
            background-color: #ddf4ff;
            border-color: var(--duo-blue);
            border-bottom-color: var(--duo-blue-shadow);
            color: var(--duo-blue-shadow);
        }

        .btn.correct {
            background-color: #d7ffb8;
            border-color: var(--duo-green);
            border-bottom-color: var(--duo-green-shadow);
            color: var(--duo-green-shadow);
        }

        .btn.wrong {
            background-color: #ffdfe0;
            border-color: var(--duo-red);
            border-bottom-color: var(--duo-red-shadow);
            color: var(--duo-red-shadow);
        }

        .btn-primary {
            background-color: var(--duo-green);
            color: white;
            border-color: var(--duo-green);
            border-bottom-color: var(--duo-green-shadow);
            text-align: center;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn-primary:hover {
            background-color: #61e002;
        }

        /* --- Feedback Footer --- */
        .footer-area {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            border-top: 2px solid transparent;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            z-index: 10;
        }

        .footer-area.show {
            transform: translateY(0);
        }

        .footer-area.correct {
            background-color: #d7ffb8;
            border-color: #b7e890;
            color: var(--duo-green-shadow);
        }

        .footer-area.wrong {
            background-color: #ffdfe0;
            border-color: #ffc1c1;
            color: var(--duo-red-shadow);
        }

        .feedback-content {
            display: flex;
            flex-direction: column;
            max-width: 600px;
            width: 100%;
            margin: 0 auto;
        }

        .feedback-title {
            font-weight: 800;
            font-size: 1.4rem;
            margin-bottom: 5px;
        }

        .feedback-text {
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 400;
        }

        /* Desktop View Adjustments */
        @media (min-width: 768px) {
            .options-grid {
                grid-template-columns: 1fr 1fr;
            }
            .container {
                justify-content: center;
            }
            #quiz-screen {
                justify-content: center;
            }
            .question-box {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <div id="welcome-screen">
            <h1>VOCAB MASTER</h1>
            <p>50 New Words.<br>Nunito Style.<br>Let's do this.</p>
            <br>
            <input type="text" id="username-input" placeholder="Enter your name">
            <button class="btn btn-primary" id="start-btn">Start Learning</button>
        </div>

        <div id="quiz-screen">
            <div class="header-bar">
                <div onclick="location.reload()" style="font-weight: 800; color: var(--duo-gray-text); cursor:pointer;">X</div>
                <div class="progress-bar-bg">
                    <div class="progress-bar-fill" id="progress-bar"></div>
                </div>
            </div>
            
            <div class="word-status" id="word-status"></div>
            <div class="question-box" id="question-text">
                Loading...
            </div>

            <div class="options-grid" id="options-container">
                </div>
        </div>

        <div id="end-screen" style="display: none;">
            <h1>CONGRATULATIONS!</h1>
            <h2 id="congrats-name" style="color: var(--duo-blue);"></h2>
            <p>You have cleared the list!</p>
            <br>
            <button class="btn btn-primary" onclick="location.reload()">Play Again</button>
        </div>
    </div>

    <div class="footer-area" id="footer">
        <div class="feedback-content">
            <div class="feedback-title" id="feedback-title">Correct!</div>
            <div class="feedback-text" id="feedback-definition">Definition goes here.</div>
            <button class="btn btn-primary" id="next-btn">CONTINUE</button>
        </div>
    </div>

    <script>
        // --- DATA ---
        const rawData = [
            { w: "Replete", d: "full, abundant", s: "The unedited version was replete with naughty words." },
            { w: "Repose", d: "to rest, lie down", s: "The cat, after eating an entire can of tuna fish, reposed in the sun and took a long nap." },
            { w: "Reprehensible", d: "deserving rebuke", s: "Jeanâ€™s cruel and reprehensible attempt to dump her boyfriend on his birthday led to tears and recriminations." },
            { w: "Reprieve", d: "a temporary delay of punishment", s: "Because the governor woke up in a particularly good mood, he granted hundreds of reprieves to prisoners." },
            { w: "Reproach", d: "to scold, disapprove", s: "Brian reproached the customer for failing to rewind the video he had rented." },
            { w: "Reprobate", d: "evil, unprincipled", s: "The reprobate criminal sat sneering in the cell." },
            { w: "Reprove", d: "to scold, rebuke", s: "Lara reproved her son for sticking each and every one of his fingers into the strawberry pie." },
            { w: "Repudiate", d: "to reject, refuse to accept", s: "Kwame made a strong case for an extension of his curfew, but his mother repudiated it with a few biting words." },
            { w: "Repulse", d: "to disgust", s: "Antisocial Annie tried to repulse people by neglecting to brush her teeth." },
            { w: "Reputable", d: "of good reputation", s: "After the most reputable critic in the industry gave the novel a glowing review, sales took off." },
            { w: "Requisition", d: "a demand for goods, usually made by an authority", s: "During the war, the government made a requisition of supplies." },
            { w: "Rescind", d: "to take back, repeal", s: "The company rescinded its offer of employment after discovering that Janeâ€™s resume was full of lies." },
            { w: "Reservoir", d: "reserves, large supply", s: "Igor the Indomitable had quite a reservoir of strengh and could lift ten tons." },
            { w: "Resilient", d: "able to recover from misfortune; able to withstand adversity", s: "The resilient ballplayer quickly recovered from his wrist injury." },
            { w: "Resolute", d: "firm, determined", s: "With a resolute glint in her eye, Catherine announced that she was set on going to college." },
            { w: "Resolve", d: "to find a solution", s: "Sarah and Emma resolved their differences and shook hands." },
            { w: "Respite", d: "a break, rest", s: "Justin left the pub to gain a brief respite from the smoke and noise." },
            { w: "Resplendent", d: "shiny, glowing", s: "The partygoers were resplendent in diamonds and fancy dress." },
            { w: "Restitution", d: "restoration to the rightful owner", s: "Many people feel that descendants of slaves should receive restitution for the sufferings of their ancestors." },
            { w: "Restive", d: "resistant, stubborn, impatient", s: "The restive audience pelted the band with mud and yelled nasty comments." },
            { w: "Retract", d: "withdraw", s: "As the media worked itself into a frenzy, the publicist hurriedly retracted his clientâ€™s sexist statement." },
            { w: "Revel", d: "to enjoy intensely", s: "Theodore reveled in his new status as Big Man on Campus." },
            { w: "Revere", d: "to esteem, show deference, venerate", s: "The doctor saved countless lives with his combination of expertise and kindness and became universally revered." },
            { w: "Revoke", d: "to take back", s: "After missing the curfew set by the court for eight nights in a row, Marcelâ€™s freedom of movement was revoked." },
            { w: "Rhapsodize", d: "to engage in excessive enthusiasm", s: "The critic rhapsodized about the movie, calling it an instant classic." },
            { w: "Ribald", d: "coarsely, crudely humorous", s: "While some giggled at the ribald joke involving a parsonâ€™s daughter, most sighed and rolled their eyes." },
            { w: "Rife", d: "abundant", s: "Surprisingly, the famous novelistâ€™s writing was rife with spelling errors." },
            { w: "Ruminate", d: "to contemplate, reflect", s: "Terry liked to ruminate while sitting on the banks of the river, staring pensively into the water." },
            { w: "Ruse", d: "a trick", s: "Oliver concocted an elaborate ruse for sneaking out of the house to meet his girlfriend." },
            { w: "Saccharine", d: "sickeningly sweet", s: "Tomâ€™s saccharine manner, although intended to make him popular, actually repelled his classmates." },
            { w: "Sacrosanct", d: "holy, something that should not be criticized", s: "In the United States, the Constitution is often thought of as a sacrosanct document." },
            { w: "Sagacity", d: "shrewdness, soundness of perspective", s: "With remarkable sagacity, the wise old man predicted and thwarted his childrenâ€™s plan to ship him off to a nursing home." },
            { w: "Salient", d: "significant, conspicuous", s: "One of the salient differences between Alison and Nancy is that Alison is a foot taller." },
            { w: "Salutation", d: "a greeting", s: "Andrew regularly began letters with the bizarre salutation â€œAhoy ahoy.â€" },
            { w: "Salve", d: "a soothing balm", s: "After Tony applied a salve to his brilliant red sunburn, he soon felt a little better." },
            { w: "Sanctimonious", d: "giving a hypocritical appearance of piety", s: "The sanctimonious Bertrand delivered stern lectures on the Ten Commandments." },
            { w: "Sanguine", d: "optimistic, cheery", s: "Polly reacted to any bad news with a sanguine smile." },
            { w: "Satiate", d: "to satisfy excessively", s: "Satiated after eating far too much turkey and stuffing, Liza lay on the couch." },
            { w: "Scathing", d: "sharp, critical, hurtful", s: "Two hours after breaking up with Russell, Suzanne thought of the perfect scathing retort." },
            { w: "Scintillating", d: "sparkling", s: "The ice skaterâ€™s scintillating rhinestone costume nearly blinded the judges." },
            { w: "Scrupulous", d: "painstaking, careful", s: "With scrupulous care, Sam cut a snowflake out of white paper." },
            { w: "Scurrilous", d: "vulgar, coarse", s: "When Bruno heard the scurrilous accusation being made about him, he could not believe it." },
            { w: "Sedentary", d: "sitting, settled", s: "The sedentary cat did little but loll in the sun." },
            { w: "Semaphore", d: "a visual signal", s: "Anne and Diana communicated with a semaphore involving candles and window shades." },
            { w: "Seminal", d: "original, important, creating a field", s: "Stephen Greenblattâ€™s essays on Shakespeare proved to be seminal." },
            { w: "Sensual", d: "involving sensory gratification, usually related to sex", s: "With a coy smile, the guest on the blind-date show announced that he considered himself a very sensual person." },
            { w: "Sensuous", d: "involving sensory gratification", s: "Paul found drinking Coke, with all the bubbles, a very sensuous experience." },
            { w: "Serendipity", d: "luck, finding good things without looking for them", s: "In an amazing bit of serendipity, penniless Paula found a $20 bill in the subway station." },
            { w: "Serene", d: "calm, untroubled", s: "Louise stood in front of the Mona Lisa, puzzling over the famous womanâ€™s serene smile." },
            { w: "Servile", d: "subservient", s: "The servile porter crept around the hotel lobby, bowing and quaking before the guests." },
            { w: "Sinuous", d: "lithe, serpentine", s: "With the sinuous movements of her arms, the dancer mimicked the motion of a snake." }
        ];

        // --- STATE MANAGEMENT ---
        let appState = {
            user: "",
            words: [], 
            currentQuestion: null, 
            isWaitingForNext: false
        };

        // --- SOUND CONTROLLER (Web Audio API) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        const playSound = (type) => {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.5);
            } else if (type === 'wrong') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
                osc.start();
                osc.stop(audioCtx.currentTime + 0.4);
            } else if (type === 'finish') {
                const now = audioCtx.currentTime;
                [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                    const o = audioCtx.createOscillator();
                    const g = audioCtx.createGain();
                    o.connect(g);
                    g.connect(audioCtx.destination);
                    o.frequency.value = freq;
                    o.type = 'triangle';
                    g.gain.setValueAtTime(0.2, now + i*0.1);
                    g.gain.exponentialRampToValueAtTime(0.001, now + i*0.1 + 0.5);
                    o.start(now + i*0.1);
                    o.stop(now + i*0.1 + 0.5);
                });
            }
        };

        // --- INITIALIZATION ---
        function init() {
            appState.words = rawData.map((item, index) => ({
                id: index,
                word: item.w,
                def: item.d,
                sentence: item.s,
                correctCount: 0,
                consecutive: 0,
                isDeleted: false
            }));

            const startBtn = document.getElementById('start-btn');
            const nextBtn = document.getElementById('next-btn');

            startBtn.addEventListener('click', startGame);
            nextBtn.addEventListener('click', nextQuestion);

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    if (appState.isWaitingForNext) {
                        nextQuestion();
                    } else if (document.getElementById('welcome-screen').style.display !== 'none') {
                        startGame();
                    }
                }
            });
        }

        function startGame() {
            const input = document.getElementById('username-input');
            const name = input.value.trim() || "Learner";
            appState.user = name;

            document.getElementById('welcome-screen').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'flex';
            
            generateQuestion();
        }

        // --- GAME LOGIC ---
        function generateQuestion() {
            const availablePool = appState.words.filter(w => !w.isDeleted);

            if (availablePool.length === 0) {
                showEndScreen();
                return;
            }

            // Weighted random selection: Give slightly higher chance to "maintained" words to clear them out, or new words
            const targetWord = availablePool[Math.floor(Math.random() * availablePool.length)];

            // Create Masked Sentence (looks for first 4 letters to handle tenses)
            const regex = new RegExp(targetWord.word.substring(0, 4), 'i'); 
            const maskedSentence = targetWord.sentence.replace(regex, "_______");

            // Pick 3 distractors
            const distractors = [];
            while (distractors.length < 3) {
                const r = rawData[Math.floor(Math.random() * rawData.length)];
                // Ensure distractor is not the target and not already in distractors
                if (r.w !== targetWord.word && !distractors.includes(r.w)) {
                    distractors.push(r.w);
                }
            }

            const options = [...distractors, targetWord.word].sort(() => Math.random() - 0.5);

            appState.currentQuestion = {
                wordObj: targetWord,
                maskedSentence: maskedSentence,
                options: options
            };

            renderQuestion();
        }

        function renderQuestion() {
            appState.isWaitingForNext = false;

            document.getElementById('footer').classList.remove('show', 'correct', 'wrong');
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            // Status Indicator
            const w = appState.currentQuestion.wordObj;
            const statusEl = document.getElementById('word-status');
            
            if (w.correctCount >= 3) {
                statusEl.innerHTML = "ðŸ”¥ MASTERED (Next correct clears it)";
                statusEl.style.color = "orange";
            } else if (w.consecutive >= 2) {
                statusEl.innerHTML = "âœ¨ MAINTAINED";
                statusEl.style.color = "var(--duo-blue)";
            } else {
                statusEl.innerHTML = "ðŸŒ± NEW / LEARNING";
                statusEl.style.color = "var(--duo-gray-text)";
            }

            // Sentence
            document.getElementById('question-text').innerHTML = appState.currentQuestion.maskedSentence;

            // Options
            appState.currentQuestion.options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'btn';
                btn.innerText = opt;
                btn.onclick = () => handleAnswer(btn, opt);
                optionsContainer.appendChild(btn);
            });

            updateProgressBar();
        }

        function handleAnswer(btnElement, selectedOption) {
            if (appState.isWaitingForNext) return;

            const correctWord = appState.currentQuestion.wordObj.word;
            const isCorrect = selectedOption === correctWord;
            
            const allBtns = document.querySelectorAll('.options-grid .btn');
            allBtns.forEach(b => {
                b.disabled = true;
                if (b.innerText === correctWord) b.classList.add('correct');
                else if (b === btnElement && !isCorrect) b.classList.add('wrong');
            });

            updateWordStats(isCorrect);

            const footer = document.getElementById('footer');
            const title = document.getElementById('feedback-title');
            const text = document.getElementById('feedback-definition');
            
            footer.classList.remove('correct', 'wrong');
            if (isCorrect) {
                footer.classList.add('correct');
                title.innerText = "Nicely done!";
                playSound('correct');
            } else {
                footer.classList.add('wrong');
                title.innerText = "Correct answer: " + correctWord;
                playSound('wrong');
            }

            text.innerHTML = `<strong>Definition:</strong> ${appState.currentQuestion.wordObj.def}`;
            footer.classList.add('show');
            
            appState.isWaitingForNext = true;
        }

        function updateWordStats(isCorrect) {
            const word = appState.currentQuestion.wordObj;

            if (isCorrect) {
                word.consecutive++;
                word.correctCount++;
                
                // Rule: 4th time right -> Delete (Clear)
                if (word.correctCount >= 4) {
                    word.isDeleted = true;
                }
            } else {
                // Rule: Wrong -> Consecutive resets, but don't delete progress completely
                word.consecutive = 0;
            }
        }

        function nextQuestion() {
            if (!appState.isWaitingForNext) return;
            generateQuestion();
        }

        function updateProgressBar() {
            const total = appState.words.length;
            const deleted = appState.words.filter(w => w.isDeleted).length;
            const percentage = (deleted / total) * 100;
            document.getElementById('progress-bar').style.width = percentage + '%';
        }

        function showEndScreen() {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('end-screen').style.display = 'flex';
            document.getElementById('congrats-name').innerText = appState.user;
            playSound('finish');
        }

        // Run
        init();

    </script>
</body>
</html>
